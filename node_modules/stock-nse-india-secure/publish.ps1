# Simple publish script for secure stock-nse-india fork
Write-Host "Publishing secure stock-nse-india fork..." -ForegroundColor Green

# Check npm login
Write-Host "Checking npm authentication..." -ForegroundColor Yellow
try {
    $npmUser = npm whoami 2>$null
    if ($LASTEXITCODE -eq 0) {
        Write-Host "Logged in as: $npmUser" -ForegroundColor Green
    } else {
        Write-Host "Please login to npm first:" -ForegroundColor Red
        Write-Host "npm login" -ForegroundColor White
        exit 1
    }
} catch {
    Write-Host "Please login to npm first:" -ForegroundColor Red
    Write-Host "npm login" -ForegroundColor White
    exit 1
}

# Build and publish
Write-Host "Building package..." -ForegroundColor Yellow
npm run build

if ($LASTEXITCODE -eq 0) {
    Write-Host "Publishing to npm..." -ForegroundColor Yellow
    npm publish --access public
    
    if ($LASTEXITCODE -eq 0) {
        Write-Host "Successfully published!" -ForegroundColor Green
        Write-Host "Next: Update your project to use @vercelink/stock-nse-india-secure" -ForegroundColor Cyan
    } else {
        Write-Host "Publish failed!" -ForegroundColor Red
    }
} else {
    Write-Host "Build failed!" -ForegroundColor Red
}
